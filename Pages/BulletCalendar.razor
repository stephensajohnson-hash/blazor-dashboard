// ... inside SaveItem() method ...

    private async Task SaveItem() { 
        if(editingItem != null) {
            if (editingItem.Type == "meeting") { var m = new BulletMeetingService.MeetingDTO { Id = editingItem.Id, UserId = editingItem.UserId, Type = "meeting", Category = editingItem.Category, Date = editingItem.Date, Title = editingItem.Title, Description = editingItem.Description, ImgUrl = editingItem.ImgUrl, LinkUrl = editingItem.LinkUrl, OriginalStringId = editingItem.OriginalStringId, Detail = editingItem.MeetingDetail, Notes = editingItem.Notes, SortOrder = editingItem.SortOrder }; await MeetingService.SaveMeeting(m); }
            else if (editingItem.Type == "habit") { var h = new BulletHabitService.HabitDTO { Id = editingItem.Id, UserId = editingItem.UserId, Type = "habit", Category = editingItem.Category, Date = editingItem.Date, Title = editingItem.Title, Description = editingItem.Description, ImgUrl = editingItem.ImgUrl, LinkUrl = editingItem.LinkUrl, OriginalStringId = editingItem.OriginalStringId, Detail = editingItem.HabitDetail, Notes = editingItem.Notes, SortOrder = editingItem.SortOrder }; await HabitService.SaveHabit(h); }
            else if (editingItem.Type == "media") { var m = new BulletMediaService.MediaDTO { Id = editingItem.Id, UserId = editingItem.UserId, Type = "media", Category = editingItem.Category, Date = editingItem.Date, Title = editingItem.Title, Description = editingItem.Description, ImgUrl = editingItem.ImgUrl, LinkUrl = editingItem.LinkUrl, OriginalStringId = editingItem.OriginalStringId, Detail = editingItem.MediaDetail, Notes = editingItem.Notes, SortOrder = editingItem.SortOrder }; await MediaService.SaveMedia(m); }
            else if (editingItem.Type == "holiday") { var h = new BulletHolidayService.HolidayDTO { Id = editingItem.Id, UserId = editingItem.UserId, Type = "holiday", Category = editingItem.Category, Date = editingItem.Date, Title = editingItem.Title, Description = editingItem.Description, ImgUrl = editingItem.ImgUrl, LinkUrl = editingItem.LinkUrl, OriginalStringId = editingItem.OriginalStringId, Detail = editingItem.HolidayDetail, Notes = editingItem.Notes, SortOrder = editingItem.SortOrder }; await HolidayService.SaveHoliday(h); }
            else if (editingItem.Type == "birthday") { var b = new BulletBirthdayService.BirthdayDTO { Id = editingItem.Id, UserId = editingItem.UserId, Type = "birthday", Category = editingItem.Category, Date = editingItem.Date, Title = editingItem.Title, Description = editingItem.Description, ImgUrl = editingItem.ImgUrl, LinkUrl = editingItem.LinkUrl, OriginalStringId = editingItem.OriginalStringId, Detail = editingItem.BirthdayDetail, Notes = editingItem.Notes, SortOrder = editingItem.SortOrder }; await BirthdayService.SaveBirthday(b); }
            else if (editingItem.Type == "anniversary") { var a = new BulletAnniversaryService.AnniversaryDTO { Id = editingItem.Id, UserId = editingItem.UserId, Type = "anniversary", Category = editingItem.Category, Date = editingItem.Date, Title = editingItem.Title, Description = editingItem.Description, ImgUrl = editingItem.ImgUrl, LinkUrl = editingItem.LinkUrl, OriginalStringId = editingItem.OriginalStringId, Detail = editingItem.AnniversaryDetail, Notes = editingItem.Notes, SortOrder = editingItem.SortOrder }; await AnniversaryService.SaveAnniversary(a); }
            else if (editingItem.Type == "vacation") 
            { 
                // VACATION RANGE LOGIC
                var start = editingItem.Date.Date;
                var end = (editingItem.EndDate ?? start).Date;
                if(end < start) end = start;

                // Loop through every day in range
                for (var dt = start; dt <= end; dt = dt.AddDays(1))
                {
                    // Create NEW DTO for this day (or update if ID matches, but range usually implies new creation/overwrite)
                    // If creating new range, Id should be 0. If editing single item, loop runs once.
                    // We treat range save as "create new items for these days" to keep it simple.
                    // If user is editing an existing item #5, we save #5 on StartDate, and create new items for subsequent days.
                    
                    int currentId = (dt == start) ? editingItem.Id : 0; 

                    var v = new BulletVacationService.VacationDTO { 
                        Id = currentId, 
                        UserId = editingItem.UserId, 
                        Type = "vacation", 
                        Category = editingItem.Category, 
                        Date = dt, // Incrementing date
                        Title = editingItem.Title, 
                        Description = editingItem.Description, 
                        ImgUrl = editingItem.ImgUrl, 
                        LinkUrl = editingItem.LinkUrl, 
                        OriginalStringId = editingItem.OriginalStringId, 
                        Detail = editingItem.VacationDetail, 
                        Notes = editingItem.Notes, 
                        SortOrder = editingItem.SortOrder 
                    }; 
                    await VacationService.SaveVacation(v);
                }
            }
            else { await TaskService.SaveTask(editingItem); }
            editingItem = null; await LoadData();
        }
    }