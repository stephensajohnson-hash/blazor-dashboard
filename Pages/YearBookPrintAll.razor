@page "/year-book-print-all/{Year:int}"
@using Dashboard
@using Microsoft.JSInterop
@layout EmptyLayout
@rendermode @(new Microsoft.AspNetCore.Components.Web.InteractiveServerRenderMode(prerender: false))

@inject IJSRuntime JS

<div class="print-controls bg-black p-4 sticky top-0 z-[200] flex justify-between items-center no-print border-b border-gray-800">
    <div class="text-white font-black uppercase text-sm">Stephens' @Year Journal</div>
    <button @onclick="TriggerPrint" class="bg-blue-600 text-white px-10 py-2 rounded-lg font-black shadow-lg">PRINT NOW</button>
</div>

<div class="print-book">
    @* PAGE 1 and following are now handled entirely within the YearBookExport loop *@
    @{ int currentPage = 0; }
    @for (int m = 1; m <= 12; m++)
    {
        <YearBookExport Year="Year" Month="m" StartPageNumber="currentPage" />
        
        @* Approximate increment: Cover(1) + Spread(2) + Days(31) = 34 *@
        currentPage += 34; 
    }
</div>

<style>
    /* Physical Print Margins and Gutter for Binding */
    .print-page { 
        width: 8.5in; 
        min-height: 11in; 
        position: relative; 
        background: white; 
        page-break-after: always; 
        display: flex; 
        flex-direction: column; 
    }
    
    /* Gutter Logic: Left pages need .5in on the RIGHT, Right pages need .5in on the LEFT */
    .page-left { padding-right: 0.6in; padding-left: 0.2in; }
    .page-right { padding-left: 0.6in; padding-right: 0.2in; }
    
    .month-vertical-label { 
        writing-mode: vertical-rl; 
        transform: rotate(180deg); 
        font-size: 5rem; 
        font-weight: 900; 
        line-height: 1; 
        padding-top: 2rem; 
    }
    
    @@media print {
        .no-print { display: none !important; }
        body { margin: 0; padding: 0; }
        * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
    }
</style>

@code {
    [Parameter] public int Year { get; set; }
    private async Task TriggerPrint() => await JS.InvokeVoidAsync("print");
}