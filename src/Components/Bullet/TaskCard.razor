@namespace Dashboard.Components.Bullet
@using Dashboard

<BaseItemCard Item="Item" Notes="Item.Notes" IsCompleted="Item.Detail.IsCompleted" 
              BorderClass="border-gray-700 hover:border-blue-500"
              OnEdit="HandleClick" OnDelete="HandleDelete" OnToggle="HandleToggle">
    <ChildContent>
        @if(!string.IsNullOrEmpty(Item.Detail.TicketNumber)) { 
            <span class="text-[9px] bg-blue-900/30 text-blue-300 border border-blue-800 px-1.5 py-0.5 rounded uppercase tracking-wider">
                @Item.Detail.TicketNumber
            </span> 
        }
        @if(Item.Detail.Priority == "High") { 
            <span class="text-[9px] bg-red-900/30 text-red-300 border border-red-800 px-1.5 py-0.5 rounded uppercase tracking-wider">High</span> 
        }
    </ChildContent>
</BaseItemCard>

@code {
    [Parameter] public BulletTaskService.TaskDTO Item { get; set; } = new();
    [Parameter] public EventCallback<BulletTaskService.TaskDTO> OnClick { get; set; }
    [Parameter] public EventCallback<BulletTaskService.TaskDTO> OnToggle { get; set; }
    [Parameter] public EventCallback<int> OnDelete { get; set; }

    private async Task HandleClick() => await OnClick.InvokeAsync(Item);
    private async Task HandleDelete() => await OnDelete.InvokeAsync(Item.Id);
    
    private async Task HandleToggle(bool val) {
        Item.Detail.IsCompleted = val;
        await OnToggle.InvokeAsync(Item);
    }
}