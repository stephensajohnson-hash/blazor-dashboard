@namespace Dashboard.Components.Bullet
@using Dashboard

<div class="bg-gray-800 border border-gray-600 rounded mb-1 overflow-hidden cursor-pointer transition flex group relative pr-6 shadow-sm hover:bg-gray-700" @onclick="HandleClick">
    
    <div class="absolute right-0 top-0 bottom-0 w-5 flex flex-col opacity-0 group-hover:opacity-100 transition z-20 bg-black/20 backdrop-blur-sm border-l border-white/10">
        <button @onclick="MoveUp" @onclick:stopPropagation="true" class="flex-1 hover:bg-white/20 text-[8px] flex items-center justify-center text-white leading-none">▲</button>
        <button @onclick="MoveDown" @onclick:stopPropagation="true" class="flex-1 hover:bg-white/20 text-[8px] flex items-center justify-center text-white leading-none">▼</button>
    </div>

    <div class="p-1 flex-1 min-w-0 flex items-center justify-center gap-3 relative">
        
        @if(Item.Detail.IsComplete)
        {
             // If complete, determine outcome for border color or subtle background
             // For pill, let's keep it simple: Scores
        }

        <div class="flex items-center gap-1.5">
            @if(!string.IsNullOrEmpty(Item.AwayTeam?.LogoUrl)) { <img src="@Item.AwayTeam?.LogoUrl" class="w-5 h-5 object-contain" /> }
            else { <span class="text-[9px] font-bold text-gray-400">@Item.AwayTeam?.Abbreviation</span> }
            <span class="font-mono font-bold text-xs @(Item.Detail.AwayScore > Item.Detail.HomeScore ? "text-white" : "text-gray-500")">@Item.Detail.AwayScore</span>
        </div>

        <div class="text-[9px] text-gray-600 font-bold">@</div>

        <div class="flex items-center gap-1.5">
            <span class="font-mono font-bold text-xs @(Item.Detail.HomeScore > Item.Detail.AwayScore ? "text-white" : "text-gray-500")">@Item.Detail.HomeScore</span>
            @if(!string.IsNullOrEmpty(Item.HomeTeam?.LogoUrl)) { <img src="@Item.HomeTeam?.LogoUrl" class="w-5 h-5 object-contain" /> }
            else { <span class="text-[9px] font-bold text-gray-400">@Item.HomeTeam?.Abbreviation</span> }
        </div>

    </div>
</div>

@code {
    [Parameter] public BulletSportsService.GameDTO Item { get; set; } = new();
    [Parameter] public EventCallback<BulletTaskService.TaskDTO> OnClick { get; set; }
    [Parameter] public EventCallback<int> OnMoveUp { get; set; }
    [Parameter] public EventCallback<int> OnMoveDown { get; set; }

    private async Task HandleClick() 
    {
        await OnClick.InvokeAsync(new BulletTaskService.TaskDTO { Id = Item.Id, Type = "sports" });
    }
    private async Task MoveUp() => await OnMoveUp.InvokeAsync(Item.Id);
    private async Task MoveDown() => await OnMoveDown.InvokeAsync(Item.Id);
}