@namespace Dashboard.Components.Bullet
@using Dashboard
@using Microsoft.AspNetCore.Components.Web

<div class="text-xs rounded mb-1 border group relative cursor-pointer overflow-hidden transition hover:scale-105 flex items-center
     @(Task.Detail.IsCompleted ? "bg-gray-800 text-gray-500 border-gray-700" : "bg-gray-700 text-gray-200 border-gray-600 hover:border-blue-400")" 
     @onclick="HandleClick" @onclick:stopPropagation="true" title="@Task.Title">
    
    @if(!string.IsNullOrEmpty(Task.ImgUrl))
    {
        <div class="h-full shrink-0 bg-black" style="width: @ImageWidth; min-height: 20px;">
            <img src="@Task.ImgUrl" class="w-full h-full object-cover opacity-90" />
        </div>
    }

    <div class="px-1.5 py-1 flex-1 truncate @(Task.Detail.IsCompleted ? "line-through" : "")">
        @Task.Title
    </div>
</div>

@code {
    [Parameter] public BulletTaskService.TaskDTO Task { get; set; } = new();
    [Parameter] public EventCallback<BulletTaskService.TaskDTO> OnClick { get; set; }
    
    // Default to Week width, but allow Month view to override
    [Parameter] public string ImageWidth { get; set; } = BulletViewConfig.ImgWidthWeek; 

    private async Task HandleClick() => await OnClick.InvokeAsync(Task);
}